-module(keccak_tests).
-include_lib("eunit/include/eunit.hrl").

check_vector({Data, Expected}) ->
    Found = keccak:hash512(Data),
    ?assert(Found =:= Expected).

check_vectors_test_() ->
    fun () -> 
	    Vectors = [
{<<"v7LyiwuCrB7EgAibPve6Yg2gLmggxE6j7ocR37EudrH_P9XX2rQK">>,
<<164,159,53,119,79,126,139,203,210,74,128,13,124,222,127,
  155,0,157,99,29,83,199,15,182,23,180,219,99,88,14,179,
  168,156,213,240,154,218,250,194,21,228,66,85,236,119,68,
  104,203,216,243,42,49,26,57,231,6,240,96,236,137,75,71,
  115,12>>},
{<<"4Ks1pPO_2wGYR-gfJShqUO-FirA9c5cF4oKwvStp2Ix5hHUg2klPofVJ8TZoBdFfgTh8">>,
<<101,182,139,119,106,61,148,184,42,189,183,107,143,89,
  196,171,136,196,237,124,28,112,98,223,206,133,77,194,
  120,244,149,109,165,40,124,56,44,6,238,85,80,127,211,23,
  36,208,116,26,96,60,2,238,60,225,63,246,22,119,78,161,
  155,9,209,46>>},
{<<"bMQudI8yVdDx5ScGQCMQy4K_QXYCq1w1eC">>,
<<223,79,201,250,182,157,125,149,212,119,255,202,177,56,
  24,248,98,172,58,85,27,12,196,12,226,115,11,173,142,169,
  152,131,149,174,26,253,139,193,232,39,155,39,129,66,88,
  222,93,105,47,66,249,60,162,168,154,27,218,79,47,85,97,
  172,48,71>>},
{<<"Wh8yRitk__n4MsETCTRFrB4bjWRtPjUZVLPnywlvv5nTMA2C71">>,
<<32,34,219,176,57,28,59,59,118,193,172,158,255,58,123,
  236,90,66,95,73,225,230,110,127,101,24,157,65,92,32,83,
  84,208,114,17,166,101,3,0,200,161,63,65,104,134,165,36,
  27,134,114,13,213,45,110,139,204,119,209,41,114,234,64,
  182,62>>},
{<<"f-NT">>,
<<48,212,68,142,226,137,208,213,185,244,36,56,83,10,243,
  205,199,162,163,216,182,60,96,115,155,227,140,192,90,
  119,123,11,61,190,219,213,150,48,66,161,104,247,8,17,
  250,188,53,137,72,0,178,75,24,227,219,143,118,149,95,
  180,166,237,63,63>>}],
        lists:foreach(fun check_vector/1, Vectors)
    end.
